---
title: "Lab 2 - Data wrangling"
author: "Sheila Yu"
date: "Feburary 4th, 2026"
format: html
---

```{r}
#| eval: true
#| message: false

library(tidyverse)
data <- midwest
```

# Questions

## Part 1

### Question 1

```{r}
counties_by_state <- data %>%
  count(state, name = "n_counties") %>%
  arrange(desc(n_counties))

counties_by_state

```

The code above displays calculation the number of counties in each state. Based on the calculation, Illinois (IL) has the highest number of counties, with a total of 102 counties. Wisconsin (WI) has the lowest number of counties, with a total of 72 counties.

\newpage

### Question 2

```{r}
data %>%
  count(county, name = "n_states") %>%
  filter(n_states == n_distinct(midwest$state))
```

Based on the result above, the county that fills in the blank of “Look at that, there is a county called \_\_\_ in each state in this dataset!” includes Crawford, Jackson and Monroe.

\newpage

### Question 3

Part a:\

```{r}
data %>%
  filter(popdensity > 25000) %>%
  select(county, state, popdensity, poptotal, area) %>%
  arrange(desc(popdensity))
```

Based on the results above, there are a total of nine counties with a population density above 25,000. These counties include: Cook, Milwaukee, Wayne, Cuyahoga, Du Page, Marion, Hamilton, Franklin and Macomb.

Part b:

```{r}
data %>%
  filter(popdensity == max(popdensity, na.rm = TRUE)) %>%
  select(county, state, popdensity, poptotal, area)
```

Based on the result above, the county with the highest population density is Cook.

\newpage

### Question 4

```{r}
data %>%
  summarise(
    median_density = median(popdensity, na.rm = TRUE),
    q1 = quantile(popdensity, 0.25, na.rm = TRUE),
    q3 = quantile(popdensity, 0.75, na.rm = TRUE)
  )
```

The distribution of population density of counties is unimodal and extremely right-skewed. A typical Midwestern county has population density of 1156 people per unit area. The middle 50% of the counties have population densities between 622 to 2330 people per unit area.

\*Please note that the data are rounded to the nearest whole number.

\newpage

### Question 5

```{r}
data %>%
  mutate(metro = if_else(inmetro == 1, "Yes", "No")) %>%
  count(state, metro) %>%
  group_by(state) %>%
  mutate(proportion = n / sum(n)) %>%
  ungroup()
```

Here is a table with results from the calculation above displayed and rounded of to nearest percentage:

| State | Metro or not | Proportion of population in the area |
|-------|--------------|--------------------------------------|
| IL    | No           | 73%                                  |
| IL    | Yes          | 27%                                  |
| IN    | No           | 60%                                  |
| IN    | Yes          | 40%                                  |
| MI    | No           | 70%                                  |
| MI    | Yes          | 30%                                  |
| OH    | No           | 55%                                  |
| OH    | Yes          | 45%                                  |
| WI    | No           | 72%                                  |
| WI    | Yes          | 28%                                  |

\newpage

### Question 6

\newpage

### Question 7

\newpage

### Question 8

\newpage

## Part 2

### Question 9
